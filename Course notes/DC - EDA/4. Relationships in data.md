

# 4 Relationships in data

## 4.1 Patterns over time

> Resource: [pd.to_datetime w3resource.com](https://www.w3resource.com/pandas/to_datetime.php)

When we work with time data, we must ensure that python understands that we are managing date's data type.  Typically, when we download data, date data is interpreted as string.


**String data to datetime data**
To ensure working with date data we have two options
 - **Import** as date data type data that should be interpreted as date data
 - **Convert** data to date data type

_Import DateTime data _
`parse_dates = [list of cols]` is an argument of the `pd.read_csv` function that allow to import data as datetime data
```pythond
df = pd.read_csv("file.csv", parse_dates = [list with names of columns that should be interpreted as date data])
```
_Convert to DateTime data_
`pd.to_datetime()` function converts arguments do DateTimedata
```python
df['str_col'] = pd.to_datetime(df['dte_col'])
```
**Others uses of** `pd.to_datetime()`

_Concatenating date, month and year to date column_
```python
#! to work this trick, columns of DataFrame must be named month, day and year
df['dte_col'] = pd.to_datetime(df[['month', 'day', 'year']])
```

**Extract month, day or year from DateTime data**
We can extract parts of a full date using `dt.month`, `dt.day` and `dt.year` attributes
For example: `df['month'] = df['dte_col'].dt.month`

**Visualizing patterns over time**
```python
sns.lineplot(x = 'dte_col', y = 'num_col', data = df) # dte_col can be month, day, year o datetime col
plt.show()
```

## 4.2 Correlation
The correlation between two variables describes de direction and strength of linear relationship between them. Understanding this relationship can help to use variables to predict future outcomes.

A correlation value closer to 1 or -1 indicate stronger relationship.
A value closer to 0 indicates weak linear relationship between variables.
A positive correlation coefficient indicate that both variables tends to increase at the same time, a negative correlation coefficient indicates that when one variable increases, the other decreases.



**Correlation coefficient between columns in a data frame**
`df.corr()` method finds the correlation of each column in a DataFrame, using the Pearson correlation coefficient, and measures linear relationship.

**Correlation heatmap**
A correlation heatmap shows a matrix of correlation between the column of the DataFrame, but has the benefit of coding with color the different combinations of correlation (strong, weak, positive, negative).
```python
# correlation heatmap
sns.heatmap(df.corr(), annot = True)
plt.show()
```
**Scatterplots**
Correlations only measure linear relationships.  Because of that is important to complement correlation coefficient with scatterplots to assess relationships between variables.

```python
sns.scatterplot(x = 'num_col1', y = 'num_col2', data = df)
plt.show()
```

**Pairplots**
A pairplot plots all pairwise relationships between numerical variables in one visualization.

```python
# pariplot with all variables
sns.pairplot(data = df)
plt.show()
```

```python
# pairplot with a list of variables of interest
sns.pairplot(data = df, vars = ['num_col1','num_col2','num_col3'])
plt.show()
```

## Relationships between categorical variables

### Exploring categorical relationships

**Histogram**
```python
# simple histogram
sns.histplot(x = 'cat_col', data = df, binwidth = 1)
plt.show() 
```

```python
# adding a categorical value using colors
sns.histplot(x = 'cat_col', data = df, binwidth = 1, hue = 'cat_col2')
plt.show() 
```

**Kernel Density Estimate (KDE) plots**
KDEs are similar to histograms allowing to see distributions.  Are considered more interpretable when multiple distributions are shown.
A problem with KDEs plots is that the smoothing algorithm used to calculate it, it can include values that don't make sense.

_Simple KDEplot_
```python
# simple KDEplot
sns.kdeplot(x = 'cat_col', data = df, hue = 'cat_col2') # attribute cut = 0 can be used to cut the chart in the minimum and maximum value
plt.show()
```

_KDEplot with attributes_
```python
# simple KDEplot
sns.kdeplot(x = 'cat_col', data = df, hue = 'cat_col2',
cut = 0, #can be used to cut the chart in the minimum and maximum value
cumulative = True) # to show cumulative distribution function
plt.show()
```
<!--stackedit_data:
eyJoaXN0b3J5IjpbMjY2NDkyMzQyXX0=
-->